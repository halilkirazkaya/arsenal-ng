tool: xfreerdp
tags: [network, remote-desktop, rdp, security, pentest, exploitation, authentication]

actions:
  # === BASIC AUTHENTICATION & CONNECTION ===
  - title: xfreerdp - basic connection with credentials
    desc: |
      Connects to a remote Windows machine using standard username and password authentication. 
      This is the primary method for accessing an RDP server. 
      Ensure that the target port (default 3389) is reachable through the network.
    command: "xfreerdp /v:{{target_ip}} /u:{{username}} /p:{{password}}"

  - title: xfreerdp - connection with domain
    desc: |
      Initiates a connection specifically including the Active Directory domain. 
      This is necessary when logging into machines that are part of a corporate network. 
      If the domain is not specified, the authentication might fail or default to a local account.
    command: "xfreerdp /v:{{target_ip}} /d:{{domain}} /u:{{username}} /p:{{password}}"

  - title: xfreerdp - ignore certificate validation
    desc: |
      Connects to the target while suppressing certificate warnings and validation. 
      This is highly recommended for penetration testers working with self-signed certificates or lab environments. 
      It prevents the connection from aborting due to "untrusted CA" errors.
    command: "xfreerdp /v:{{target_ip}} /u:{{username}} /p:{{password}} /cert:ignore"

  # === ADVANCED AUTHENTICATION (PENTESTING) ===
  - title: xfreerdp - pass the hash (PTH)
    desc: |
      Authenticates to the remote system using an NTLM hash instead of a cleartext password. 
      This technique is a staple in post-exploitation scenarios where a user's hash has been dumped from memory or SAM. 
      The target must support Restricted Admin mode or have specific registry settings enabled.
    command: "xfreerdp /v:{{target_ip}} /u:{{username}} /pth:{{ntlm_hash}} /cert:ignore"

  - title: xfreerdp - restricted admin mode
    desc: |
      Enables the Restricted Admin mode for the RDP session. 
      This prevents the transmission of reusable credentials to the remote server, protecting the client. 
      It is often required for successful Pass-the-Hash attacks on modern Windows systems.
    command: "xfreerdp /v:{{target_ip}} /u:{{username}} /p:{{password}} +restricted-admin /cert:ignore"

  - title: xfreerdp - nla security force
    desc: |
      Forces the connection to use Network Level Authentication (NLA). 
      NLA is a more secure method that requires the user to authenticate before a full RDP session is established. 
      Use this if the server strictly requires NLA and negotiation fails automatically.
    command: "xfreerdp /v:{{target_ip}} /u:{{username}} /p:{{password}} /sec:nla /cert:ignore"

  # === RESOURCE REDIRECTION & FILE OPERATIONS ===
  - title: xfreerdp - map local drive for file transfer
    desc: |
      Maps a local directory on the client machine to the remote RDP session as a network share. 
      This is the most efficient way to transfer files, tools, or scripts between the attacker and the victim. 
      The folder will appear inside "This PC" on the remote Windows machine.
    command: "xfreerdp /v:{{target_ip}} /u:{{username}} /p:{{password}} /drive:{{share_name|myshare}},{{local_path|/tmp}} /cert:ignore"

  - title: xfreerdp - enable clipboard and sound
    desc: |
      Enables both clipboard synchronization and audio redirection. 
      This allows for copying text or files between the host and guest via the clipboard. 
      Sound redirection is useful if you need to monitor system alerts or multimedia on the target.
    command: "xfreerdp /v:{{target_ip}} /u:{{username}} /p:{{password}} +clipboard /sound:sys:alsa /cert:ignore"

  - title: xfreerdp - smartcard redirection
    desc: |
      Redirects local smartcard readers to the remote session. 
      This is commonly used in high-security environments for multi-factor authentication. 
      Ensure the local pcscd service is running before using this flag.
    command: "xfreerdp /v:{{target_ip}} /u:{{username}} /p:{{password}} /smartcard:{{device_name}} /cert:ignore"

  # === DISPLAY & USER EXPERIENCE ===
  - title: xfreerdp - fullscreen mode with dynamic resolution
    desc: |
      Starts the RDP session in fullscreen mode and enables dynamic resolution. 
      Dynamic resolution allows the remote desktop to automatically resize when you change the window size. 
      Use the key combination Ctrl+Alt+Enter to toggle fullscreen mode during the session.
    command: "xfreerdp /v:{{target_ip}} /u:{{username}} /p:{{password}} /f +dynamic-resolution /cert:ignore"

  - title: xfreerdp - specific resolution and smart sizing
    desc: |
      Sets a fixed window resolution and enables smart sizing. 
      Smart sizing scales the remote desktop display to fit the window size without changing the remote resolution. 
      This is useful when working with high-resolution monitors while accessing lower-resolution targets.
    command: "xfreerdp /v:{{target_ip}} /u:{{username}} /p:{{password}} /w:{{width|1280}} /h:{{height|720}} /smart-sizing /cert:ignore"

  # === NETWORK & GATEWAY ===
  - title: xfreerdp - connection via RDP gateway
    desc: |
      Connects to a target machine through an intermediate RDP Gateway. 
      Gateways are often used to provide access to internal RDP servers from the internet via HTTPS. 
      You must provide credentials for both the gateway and the final destination server.
    command: "xfreerdp /v:{{target_ip}} /u:{{username}} /p:{{password}} /g:{{gateway_address}} /gu:{{gateway_user}} /gp:{{gateway_password}} /cert:ignore"

  - title: xfreerdp - prevent session lock
    desc: |
      Attempts to prevent the remote session from locking due to inactivity. 
      It injects fake mouse motion events at specified intervals to keep the session active. 
      This is helpful when monitoring long-running tasks or waiting for background processes.
    command: "xfreerdp /v:{{target_ip}} /u:{{username}} /p:{{password}} /prevent-session-lock:{{interval_sec|60}} /cert:ignore"