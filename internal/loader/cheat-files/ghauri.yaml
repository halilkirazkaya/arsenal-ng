tool: ghauri
tags: [sql-injection, exploitation, security, pentest, enumeration, database, scanner]

actions:
  # === TARGETING & BASIC USAGE ===
  - title: ghauri - basic url scan
    desc: |
      Perform a basic SQL injection scan on a specific target URL containing a GET parameter.
      This is the most common entry point when you identify a potentially vulnerable web page with query strings.
      The tool will automatically attempt to identify the injection point and determine the backend DBMS type.
      Using the --batch flag is recommended to skip interactive prompts and use the default behavior for all questions.
    command: "ghauri -u {{url}} --batch"

  - title: ghauri - scan with post data
    desc: |
      Test for SQL injection vulnerabilities within the body of an HTTP POST request.
      This is essential for testing login forms, search bars, or any interface where data is submitted via POST instead of GET.
      The data string should be formatted as key-value pairs, such as 'id=1&name=test'.
      This command allows ghauri to analyze parameters that are not visible in the browser's address bar.
    command: "ghauri -u {{url}} --data {{post_data}} --batch"

  - title: ghauri - load request from file
    desc: |
      Load a complete HTTP request from a raw text file, which is highly useful for complex requests.
      This method is commonly used with requests captured from proxy tools like Burp Suite or OWASP ZAP.
      It ensures that all headers, cookies, and the exact structure of the request are preserved exactly as they were sent.
      This is often the most reliable way to test authenticated sessions or mobile application APIs.
    command: "ghauri -r {{request_file}} --batch"

  # === REQUEST CONFIGURATION ===
  - title: ghauri - custom headers and cookies
    desc: |
      Specify custom HTTP headers or session cookies to bypass authentication or provide necessary context.
      This is necessary when the target application requires a valid login session or specific headers like X-Forwarded-For to work.
      You can provide the entire cookie string exactly as it appears in the browser's developer tools.
      Providing these details allows the tool to reach protected areas of the application that would otherwise be inaccessible.
    command: "ghauri -u {{url}} --cookie {{cookie_string}} --header {{header_string}}"

  - title: ghauri - proxy and delay
    desc: |
      Route all traffic through a specified proxy and set a delay between individual HTTP requests.
      Using a proxy like Tor or a local Burp Suite instance helps in masking the source IP or inspecting the tool's traffic.
      The delay parameter is crucial for avoiding rate-limiting, account lockouts, or triggering Web Application Firewalls (WAF).
      Adding a delay makes the scanning process stealthier and less likely to overwhelm a fragile backend server.
    command: "ghauri -u {{url}} --proxy {{proxy_url|http://127.0.0.1:8080}} --delay {{delay_seconds|1}}"

  - title: ghauri - user agent randomization
    desc: |
      Use a randomly selected HTTP User-Agent header for each request or specify a custom one.
      This helps in bypassing basic security filters that block requests from known automated tools.
      You can also use the --mobile flag to imitate a smartphone browser if the site serves different content to mobile users.
      Changing the User-Agent makes the tool's traffic appear more like legitimate human browsing behavior.
    command: "ghauri -u {{url}} --random-agent"

  # === DETECTION & OPTIMIZATION ===
  - title: ghauri - adjustment of test level and threads
    desc: |
      Increase the depth of testing and the speed of the data extraction process.
      The level parameter (1-3) determines how many payloads are tested; higher levels include more aggressive and diverse checks.
      The threads option allows for concurrent HTTP requests, which significantly reduces the time needed for data dumping.
      Be careful with high thread counts, as they can put significant load on the target and might lead to IP blacklisting.
    command: "ghauri -u {{url}} --level {{level|1}} --threads {{threads|1}}"

  - title: ghauri - specific injection technique
    desc: |
      Force the tool to use a specific SQL injection technique rather than the default "BEST" selection.
      Available techniques include Boolean-based (B), Error-based (E), Time-based (T), and Union-based (U).
      This is useful when you already know which technique works and want to save time during the exploitation phase.
      Selecting a specific technique can also help in bypassing certain WAF rules that only monitor for specific injection patterns.
    command: "ghauri -u {{url}} --technique {{tech|BEUT}}"

  # === ENUMERATION ===
  - title: ghauri - enumerate databases
    desc: |
      Retrieve the list of all databases available on the target database management system.
      This is a vital step in the reconnaissance phase to identify where sensitive information might be stored.
      The command will automatically use the most efficient technique found during the detection phase to fetch the names.
      Once the database names are retrieved, you can focus your efforts on the most interesting ones.
    command: "ghauri -u {{url}} --dbs --batch"

  - title: ghauri - enumerate tables in a database
    desc: |
      List all tables within a specific database to understand the data structure.
      You must use the -D flag to specify the database name you want to explore.
      Identifying tables like 'users', 'passwords', or 'orders' is key to prioritizing the next steps of your assessment.
      This action helps map out the backend schema and find where the most valuable data resides.
    command: "ghauri -u {{url}} -D {{db_name}} --tables --batch"

  - title: ghauri - enumerate columns in a table
    desc: |
      Identify all column names and their associated data types within a specific table.
      Both the database name (-D) and the table name (-T) must be provided for this command to work.
      This allows you to find sensitive fields such as 'email', 'password_hash', or 'ssn'.
      Understanding the column structure is a mandatory prerequisite for dumping the actual records from the table.
    command: "ghauri -u {{url}} -D {{db_name}} -T {{table_name}} --columns --batch"

  # === EXPLOITATION & DATA EXTRACTION ===
  - title: ghauri - dump table data
    desc: |
      Extract and display the actual entries from a specific database table.
      This is the final stage of the exploitation where you actually retrieve the data you were looking for.
      You can use --start and --stop flags to limit the number of rows retrieved if the table is exceptionally large.
      The tool will format the output clearly, and the data is typically saved to a local session file for future analysis.
    command: "ghauri -u {{url}} -D {{db_name}} -T {{table_name}} --dump --batch"

  - title: ghauri - get banner and current user
    desc: |
      Retrieve the DBMS version banner, the current database name, and the current user identity.
      The banner provides critical information about the database software, which might have specific known vulnerabilities.
      Checking the current user helps determine if the application is running with high privileges (like 'sa' or 'root').
      This information is essential for determining the full impact of the SQL injection vulnerability.
    command: "ghauri -u {{url}} --banner --current-user --current-db --batch"

  - title: ghauri - interactive sql shell
    desc: |
      Launch an interactive SQL shell to execute custom SQL queries directly against the target database.
      This feature provides maximum flexibility for advanced testers who need to perform manual queries or custom functions.
      The availability of this shell depends on the success of the initial injection and the techniques supported by the server.
      It is an excellent way to verify complex logic or perform tasks that aren't covered by the automated enumeration flags.
    command: "ghauri -u {{url}} --sql-shell"

  # === MAINTENANCE ===
  - title: ghauri - flush session and fresh scan
    desc: |
      Clear the session files for the current target and force a fresh scan of the vulnerability.
      Use this when the target's environment has changed or if you suspect the previous results were inaccurate.
      Flushing the session ensures that ghauri does not use cached results from previous runs.
      This is also helpful if the tool is stuck or behaving unexpectedly due to corrupted session data.
    command: "ghauri -u {{url}} --flush-session --fresh-queries"