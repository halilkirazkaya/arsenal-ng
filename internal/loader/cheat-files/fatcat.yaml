tool: fatcat
tags: [forensics, filesystem, security, recovery, pentest, disk-analysis]

actions:
  # === INFORMATION & EXPLORATION ===
  - title: fatcat - display disk information
    desc: |
      Displays general information about the FAT filesystem within the provided image.
      This command is typically the first step in an investigation to identify the FAT type (FAT12, FAT16, or FAT32) and verify the boot sector integrity.
      It shows details such as sector size, cluster size, and the number of FAT tables present.
    command: "fatcat {{image}} -i"

  - title: fatcat - list files and directories
    desc: |
      Lists the contents of a specific directory path within the disk image.
      If no path is specified, it usually defaults to the root directory.
      This is useful for mapping the file structure and identifying interesting files for further analysis.
    command: "fatcat {{image}} -l {{path|/}}"

  - title: fatcat - list files in a specific cluster
    desc: |
      Lists all entries found within a specific cluster number on the disk.
      This is a low-level operation used when you suspect a directory exists at a specific location but it is not linked in the standard tree.
      It bypasses the directory path logic and reads the cluster's raw entry data directly.
    command: "fatcat {{image}} -L {{cluster}}"

  - title: fatcat - list deleted files
    desc: |
      Lists directory contents while specifically including entries that have been marked as deleted.
      FAT systems mark files as deleted by changing the first character of the filename, but the data often remains.
      This command helps forensic investigators identify potential evidence that a user attempted to hide or remove.
    command: "fatcat {{image}} -l {{path|/}} -d"

  # === EXTRACTION & RECOVERY ===
  - title: fatcat - extract all files
    desc: |
      Extracts the entire content of the disk image to a specified local directory.
      The -d flag ensures that even deleted files are attempted to be recovered during the process.
      Note that recovered deleted files may be corrupted if their clusters have been overwritten by newer data.
    command: "fatcat {{image}} -x {{output_directory}} -d"

  - title: fatcat - read a specific file
    desc: |
      Reads the content of a single file and outputs it to the standard output.
      You can redirect this output to a local file on your machine to extract specific evidence without extracting the whole disk.
      This is highly efficient for targeting known configuration files or logs.
    command: "fatcat {{image}} -r {{path}} > {{output_file}}"

  - title: fatcat - read raw data from cluster
    desc: |
      Reads raw data directly from a specific cluster and a specified size.
      This is crucial for manual forensic reconstruction when the filesystem metadata is severely damaged.
      It allows you to pull raw bytes from the disk image regardless of what the FAT table says.
    command: "fatcat {{image}} -R {{cluster}} -s {{size|512}}"

  # === FAT TABLE ANALYSIS ===
  - title: fatcat - compare FAT tables
    desc: |
      Analyses and compares the primary and secondary FAT tables for discrepancies.
      Standard FAT filesystems keep two copies of the allocation table; if they differ, it indicates corruption or manual tampering.
      This command is essential for verifying the structural integrity of the partition.
    command: "fatcat {{image}} -2"

  - title: fatcat - search for orphan files
    desc: |
      Performs a search for orphan files and directories that are not linked to the root directory structure.
      Orphan files often occur due to improper unmounting or intentional manipulation of the directory entries.
      This is a powerful forensic feature to find hidden data that doesn't appear in a standard file listing.
    command: "fatcat {{image}} -o"

  - title: fatcat - backup FAT tables
    desc: |
      Creates a backup of the FAT tables into a separate file.
      This should be done before performing any write operations or "hacking" the entry tables to avoid permanent data loss.
      The -t flag can specify which table to back up (0 for both, 1 for first, 2 for second).
    command: "fatcat {{image}} -b {{backup_file}} -t {{table|0}}"

  # === FILESYSTEM HACKING (WRITING) ===
  - title: fatcat - change entry cluster (Risky)
    desc: |
      Manually changes the starting cluster of a specific file or directory entry.
      This is a "hacking" command that modifies the disk image directly and can lead to corruption if used incorrectly.
      It is used in advanced forensics to manually point a filename to a different data area on the disk.
    command: "fatcat {{image}} -e {{path}} -c {{new_cluster}}"

  - title: fatcat - modify file size (Risky)
    desc: |
      Manually sets the size of a file entry in the directory structure.
      Use this when a file's metadata reports a wrong size, preventing full extraction of the underlying data.
      Warning: This command writes to the disk image; ensure you have a backup before proceeding.
    command: "fatcat {{image}} -e {{path}} -s {{new_size}}"

  - title: fatcat - fix reachable directories
    desc: |
      Attempts to automatically fix directory structures that are reachable but logically inconsistent.
      This can repair certain types of filesystem corruption where the directory links are broken.
      This command modifies the image and should only be used after manual analysis and backing up the FAT.
    command: "fatcat {{image}} -f"