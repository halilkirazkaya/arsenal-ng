tool: rpcclient
tags: [network, smb, rpc, pentest, enumeration, windows, security]

actions:
  # === CONNECTION & AUTHENTICATION ===

  - title: rpcclient - anonymous connection
    desc: |
      Establish an unauthenticated session to the target RPC service. 
      This is primarily used to check if null sessions are enabled on a Windows or Samba host. 
      If successful, it allows for initial information gathering like user enumeration without providing any credentials.
    command: "rpcclient -U \"\" -N {{target}}"

  - title: rpcclient - authenticated connection
    desc: |
      Connect to the RPC service using a specific username and password. 
      This is the standard method for interacting with the service when valid domain or local credentials have been obtained. 
      Use the "DOMAIN/Username%Password" format to ensure the authentication context is correctly interpreted.
    command: "rpcclient -U \"{{domain|WORKGROUP}}/{{username}}%{{password}}\" {{target}}"

  - title: rpcclient - pass-the-hash connection
    desc: |
      Connect to the target using a user's NT hash instead of a cleartext password. 
      This technique is essential for lateral movement after extracting hashes from memory or the SAM database. 
      Note that the hash must be provided in the 32-character hexadecimal format.
    command: "rpcclient -U \"{{username}}\" --pw-nt-hash --password=\"{{nt_hash}}\" {{target}}"

  # === USER & GROUP ENUMERATION ===

  - title: rpcclient - enumerate domain users
    desc: |
      Retrieve a list of all user accounts within the target domain. 
      This command returns the username and its corresponding Relative Identifier (RID). 
      It is a fundamental step in mapping the target's attack surface and identifying potential targets for password spraying.
    command: "rpcclient -U \"{{username}}%{{password}}\" -c \"enumdomusers\" {{target}}"

  - title: rpcclient - enumerate domain groups
    desc: |
      List all security and distribution groups within the domain. 
      Identifying group names like 'Domain Admins' or 'Schema Admins' helps attackers prioritize specific accounts for exploitation. 
      The output includes both the group name and its associated RID.
    command: "rpcclient -U \"{{username}}%{{password}}\" -c \"enumdomgroups\" {{target}}"

  - title: rpcclient - query detailed user info
    desc: |
      Get comprehensive information about a specific user account using its RID. 
      This includes details such as password last set time, account expiration, logon count, and home directory path. 
      It is highly useful for determining if an account is active or if it has interesting configuration flags.
    command: "rpcclient -U \"{{username}}%{{password}}\" -c \"queryuser {{user_rid}}\" {{target}}"

  - title: rpcclient - enumerate group members
    desc: |
      List all members of a specific group identified by its RID. 
      This allows you to see which users belong to high-privilege groups like 'Enterprise Admins'. 
      You must first find the group RID using the 'enumdomgroups' command.
    command: "rpcclient -U \"{{username}}%{{password}}\" -c \"querygroupmem {{group_rid}}\" {{target}}"

  # === SID & NAME LOOKUPS ===

  - title: rpcclient - lookup sid by name
    desc: |
      Resolve a human-readable username or group name to its unique Security Identifier (SID). 
      This is helpful when you need the exact SID for advanced exploitation techniques or access control analysis. 
      The command will return the full SID string and the type of account found.
    command: "rpcclient -U \"{{username}}%{{password}}\" -c \"lookupnames {{target_account_name}}\" {{target}}"

  - title: rpcclient - lookup name by sid
    desc: |
      Perform a reverse lookup to find the account name associated with a specific SID. 
      This is often used during 'SID cycling' where an attacker iterates through RIDs to find hidden or unlisted accounts. 
      It helps in mapping out local or domain accounts that do not appear in standard lists.
    command: "rpcclient -U \"{{username}}%{{password}}\" -c \"lookupsids {{sid}}\" {{target}}"

  # === SYSTEM & SHARE INFORMATION ===

  - title: rpcclient - enumerate network shares
    desc: |
      List all shared folders available on the target system using the SRVSVC pipe. 
      This can reveal administrative shares like C$, ADMIN$, and IPC$, as well as custom organizational shares. 
      It provides a clear view of where sensitive data might be stored across the network.
    command: "rpcclient -U \"{{username}}%{{password}}\" -c \"netshareenumall\" {{target}}"

  - title: rpcclient - enumerate system privileges
    desc: |
      List all privileges defined on the target system's Local Security Authority (LSA). 
      This command shows the various rights that can be assigned to users, such as the right to back up files or debug programs. 
      It is a key step in identifying potential privilege escalation paths.
    command: "rpcclient -U \"{{username}}%{{password}}\" -c \"enumprivs\" {{target}}"

  - title: rpcclient - query domain information
    desc: |
      Retrieve basic information about the domain the target belongs to. 
      This includes the domain name, the domain SID, and the sequence number. 
      Knowing the domain SID is crucial for crafting manual RPC requests or performing silver/golden ticket attacks.
    command: "rpcclient -U \"{{username}}%{{password}}\" -c \"querydominfo\" {{target}}"

  - title: rpcclient - enumerate printer information
    desc: |
      List information about printers and print drivers configured on the target. 
      While seemingly benign, printer services have historically been sources of critical vulnerabilities like PrintNightmare. 
      This enumeration helps identify potential print-related exploitation vectors.
    command: "rpcclient -U \"{{username}}%{{password}}\" -c \"enumprinters\" {{target}}"