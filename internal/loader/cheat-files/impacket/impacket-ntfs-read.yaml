tool: impacket-ntfs-read
tags: [forensics, storage, ntfs, impacket, security, disk-analysis, file-extraction]

actions:
  # === BASIC EXPLORATION ===
  - title: impacket-ntfs-read - interactive volume exploration
    desc: |
      Open an NTFS volume for interactive exploration in a read-only shell. 
      This is primarily used for browsing files on a raw disk image or a physical drive without the need to mount it to the host operating system. 
      It is an excellent tool for forensic analysis as it prevents accidental modification of file metadata like access times.
    command: "impacket-ntfs-read {{volume}}"

  # === FILE EXTRACTION ===
  - title: impacket-ntfs-read - extract specific file
    desc: |
      Extract a specific file from the NTFS volume using its absolute internal path. 
      This is a common technique used during credential harvesting to pull sensitive registry hives like SAM or SECURITY from an offline disk. 
      Ensure that the path starts with a backslash to represent the root of the NTFS partition.
    command: "impacket-ntfs-read -extract {{file_path}} {{volume}}"

  - title: impacket-ntfs-read - extract system hive for decryption
    desc: |
      Specifically extract the Windows SYSTEM hive from the target volume. 
      The SYSTEM hive is essential for obtaining the boot key required to decrypt secrets found in the SAM or LSA secrets. 
      This command is highly effective when dealing with virtual machine disk files or raw forensic clones.
    command: "impacket-ntfs-read -extract {{file_path}} {{volume}}"

  - title: impacket-ntfs-read - extract ntds.dit from volume
    desc: |
      Attempt to extract the Active Directory database file (ntds.dit) from a domain controller's disk image. 
      This is a critical step in offline NTDS.DIT dumping to extract domain hashes. 
      Note that this requires access to the volume where the database is stored, which might not be the C: drive in some environments.
    command: "impacket-ntfs-read -extract {{file_path}} {{volume}}"

  # === ADVANCED / TROUBLESHOOTING ===
  - title: impacket-ntfs-read - debug mode for troubleshooting
    desc: |
      Enable verbose debug output while interacting with the NTFS volume. 
      This is useful if the tool fails to parse the Master File Table (MFT) or encounters corruption in the filesystem. 
      It provides detailed information about the underlying Impacket library's interaction with the NTFS structures.
    command: "impacket-ntfs-read -debug {{volume}}"

  - title: impacket-ntfs-read - logging with timestamps
    desc: |
      Prepend a timestamp to every line of output generated by the tool. 
      This is useful for maintaining a strictly timed audit log during forensic investigations or penetration testing engagements. 
      It helps in correlating the time of file access with other events recorded in external monitoring systems.
    command: "impacket-ntfs-read -ts {{volume}}"

  - title: impacket-ntfs-read - full debug and extraction
    desc: |
      Combine extraction and debug flags to troubleshoot specific file access issues. 
      This command will attempt to extract the specified file while printing all technical metadata being processed. 
      Use this when a file exists but the tool is failing to locate its data runs or clusters.
    command: "impacket-ntfs-read -debug -extract {{file_path}} {{volume}}"