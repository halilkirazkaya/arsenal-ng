tool: impacket-mssqlinstance
tags: [network, pentest, reconnaissance, mssql, enumeration, impacket, security]

actions:
  # === BASIC ENUMERATION ===

  - title: impacket-mssqlinstance - basic mssql instance enumeration
    desc: |
      Queries the SQL Server Browser service on a remote host to identify all running MSSQL instances. 
      This is a fundamental reconnaissance step used to discover non-standard ports and instance names before attempting login. 
      It targets UDP port 1434 to retrieve configuration details about the database environment.
    command: "impacket-mssqlinstance {{target}}"

  - title: impacket-mssqlinstance - enumerate with custom timeout
    desc: |
      Adjusts the time the tool waits for a response from the target server. 
      This is particularly useful when scanning targets over high-latency connections, unstable VPNs, or congested networks. 
      Increasing the timeout prevents the script from terminating prematurely before receiving the UDP response.
    command: "impacket-mssqlinstance -timeout {{timeout_seconds|5}} {{target}}"

  # === ADVANCED TROUBLESHOOTING & LOGGING ===

  - title: impacket-mssqlinstance - enumeration with debug output
    desc: |
      Runs the tool in debug mode to provide verbose internal information about the connection process. 
      Use this when the target does not return results or when you suspect a firewall is interfering with UDP traffic. 
      It displays raw packet handling and library-level execution details which are essential for troubleshooting.
    command: "impacket-mssqlinstance -debug {{target}}"

  - title: impacket-mssqlinstance - enumeration with timestamps
    desc: |
      Adds a timestamp to every line of the output generated by the tool. 
      This is a best practice during professional penetration tests to maintain an accurate audit trail of activities. 
      It helps in correlating the scanning activity with target system logs or security monitoring alerts.
    command: "impacket-mssqlinstance -ts {{target}}"

  - title: impacket-mssqlinstance - verbose logging with custom timing
    desc: |
      Combines timestamping, debugging, and timeout adjustments for a comprehensive diagnostic scan. 
      This configuration is ideal for complex environments where you need maximum visibility into the communication flow. 
      It ensures that even slow or problematic responses are captured with detailed timing information.
    command: "impacket-mssqlinstance -debug -ts -timeout {{timeout_seconds|10}} {{target}}"