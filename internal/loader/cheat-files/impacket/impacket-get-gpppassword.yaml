tool: impacket-Get-GPPPassword
tags: [active-directory, windows, pentest, exploitation, credentials, enumeration, impacket]

actions:
  # === REMOTE ENUMERATION ===
  - title: impacket-Get-GPPPassword - Basic Domain Authentication
    desc: |
      Connect to a Domain Controller and automatically search for passwords in the SYSVOL share using standard credentials. 
      This is the most common starting point for finding cleartext passwords stored in Group Policy Preferences files like Groups.xml or ScheduledTasks.xml. 
      The tool decrypts the 'cpassword' attribute using the publicly known AES key provided by Microsoft. 
      Ensure you have valid domain user credentials to read the SYSVOL share.
    command: "impacket-Get-GPPPassword {{domain}}/{{username}}:{{password}}@{{target_ip}}"

  - title: impacket-Get-GPPPassword - Authenticate via NTLM Hashes
    desc: |
      Use NTLM hashes to authenticate to the target instead of a plaintext password. 
      This is particularly useful during lateral movement scenarios where you have captured or dumped hashes but do not have the cleartext password. 
      The hash format must be LMHASH:NTHASH, where the LM portion can be empty (aad3b435b51404eeaad3b435b51404ee). 
      This method avoids triggering password-based alerts and helps maintain a lower profile.
    command: "impacket-Get-GPPPassword -hashes {{hash}} {{domain}}/{{username}}@{{target_ip}}"

  - title: impacket-Get-GPPPassword - Specific Domain Controller and Share
    desc: |
      Specify a particular Domain Controller IP and a custom SMB share to search for GPP XML files. 
      While SYSVOL is the default, some environments might store configuration files in non-standard shares or require targeting a specific DC due to replication lag. 
      This command allows granular control over the network path and targeting. 
      Use this if the tool fails to resolve the domain name automatically or if you need to bypass certain network restrictions.
    command: "impacket-Get-GPPPassword -dc-ip {{dc_ip}} -share {{share_name|SYSVOL}} {{domain}}/{{username}}@{{target_ip}}"

  # === OFFLINE / LOCAL ANALYSIS ===
  - title: impacket-Get-GPPPassword - Parse Local XML File
    desc: |
      Decrypt credentials from a Group Policy XML file that has already been downloaded to your local machine. 
      This is the safest method as it does not generate additional SMB traffic to the Domain Controller after the file is acquired. 
      It is ideal for processing files like Groups.xml, Services.xml, or Datasources.xml found during manual enumeration. 
      The "LOCAL" keyword tells the tool to operate in offline mode without attempting a network connection.
    command: "impacket-Get-GPPPassword -xmlfile {{path_to_xml}} LOCAL"

  - title: impacket-Get-GPPPassword - Search Specific Local Directory
    desc: |
      Recursively search a local directory for any XML files containing GPP passwords. 
      This is useful when you have cloned a large portion of a SYSVOL share or a backup and want to find all potential credentials at once. 
      The tool will parse every XML file it finds and attempt to decrypt any 'cpassword' fields. 
      This saves time compared to manually identifying and passing individual files to the tool.
    command: "impacket-Get-GPPPassword -base-dir {{local_directory_path}} LOCAL"

  # === ADVANCED AUTHENTICATION ===
  - title: impacket-Get-GPPPassword - Kerberos Authentication
    desc: |
      Utilize Kerberos tickets for authentication to the target environment instead of NTLM. 
      This is essential in hardened environments where NTLM authentication is disabled or strictly monitored. 
      The command will attempt to use a valid CCache file pointed to by the KRB5CCNAME environment variable. 
      Using the -no-pass flag ensures the tool doesn't prompt for a password and relies entirely on the ticket.
    command: "impacket-Get-GPPPassword -k -no-pass -dc-ip {{dc_ip}} {{domain}}/{{username}}@{{target_fqdn}}"

  - title: impacket-Get-GPPPassword - Debug and Timestamp Logging
    desc: |
      Enable verbose debug output and add timestamps to every log entry for troubleshooting and documentation. 
      This is helpful when connection issues occur or when you need to provide a detailed audit trail of your activities. 
      Debug mode reveals underlying Impacket library calls, which can help identify if the issue is network-related or authentication-related. 
      Timestamps are useful for correlating tool activity with target system event logs.
    command: "impacket-Get-GPPPassword -debug -ts {{domain}}/{{username}}:{{password}}@{{target_ip}}"