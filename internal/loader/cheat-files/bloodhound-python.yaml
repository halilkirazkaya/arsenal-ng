tool: bloodhound-python
tags: [active-directory, enumeration, pentest, security, reconnaissance, windows, ldap]

actions:
  # === BASIC ENUMERATION ===
  - title: bloodhound-python - basic domain enumeration
    desc: |
      Performs standard collection including Group, LocalAdmin, Session, and Trusts. 
      This is the most common starting point when you have valid domain credentials. 
      The resulting JSON files are generated in the current directory and can be uploaded to the BloodHound GUI.
    command: "bloodhound-python -u {{username}} -p {{password}} -d {{domain}}  -dc {{dc_ip}}  -c Default"

  - title: bloodhound-python - collect all data including ACLs
    desc: |
      Collects all available information including detailed Access Control Lists (ACLs). 
      This method provides the most comprehensive view of the environment, enabling the discovery of complex attack paths like GenericAll or WriteDacl. 
      Note that this produces larger files and takes more time than a default scan.
    command: "bloodhound-python -u {{username}} -p {{password}} -d {{domain}}  -c All"

  - title: bloodhound-python - domain controller only collection
    desc: |
      Limits enumeration to only query the Domain Controller without connecting to individual computers. 
      This is a stealthier and faster collection method that avoids triggering alerts on workstations. 
      It is ideal for initial reconnaissance where speed and low visibility are prioritized over session data.
    command: "bloodhound-python -u {{username}} -p {{password}} -d {{domain}}  -c DCOnly"

  # === AUTHENTICATION VARIATIONS ===
  - title: bloodhound-python - enumeration with ntlm hashes
    desc: |
      Authenticates to the domain using NTLM hashes instead of a cleartext password. 
      This is particularly useful in Pass-the-Hash scenarios or when you have extracted hashes from a local database. 
      The hash should be provided in the format LM:NTLM or just the NTLM part preceded by a colon.
    command: "bloodhound-python -u {{username}} --hashes {{ntlm_hash}} -d {{domain}}"

  - title: bloodhound-python - authenticate via kerberos ticket
    desc: |
      Uses an existing Kerberos ticket (ccache file) for authentication. 
      You must ensure the KRB5CCNAME environment variable points to your ticket file before running the command. 
      This method is often preferred for lateral movement or when operating from a Linux machine joined to the realm via SSSD.
    command: "bloodhound-python -k -no-pass -d {{domain}}  -dc {{dc_hostname}} "

  - title: bloodhound-python - authenticate using AES keys
    desc: |
      Provides an AES key (128 or 256 bits) for Kerberos authentication. 
      This is an alternative to using passwords or hashes when you have captured or calculated the user's secret keys. 
      It helps in bypassing certain NTLM-only monitoring controls.
    command: "bloodhound-python -u {{username}} -aesKey {{hex_key}}  -d {{domain}} "

  # === ADVANCED COLLECTION & NETWORK ===
  - title: bloodhound-python - collect logged on users
    desc: |
      Specifically attempts to collect session information from remote computers. 
      This action typically requires local administrator privileges on the target machines to succeed. 
      It is highly effective for identifying where Domain Admins or other high-privileged users are currently logged in.
    command: "bloodhound-python -u {{username}} -p {{password}} -d {{domain}}  -c LoggedOn"

  - title: bloodhound-python - use LDAPS and custom nameserver
    desc: |
      Forces the ingestor to use LDAP over SSL/TLS (LDAPS) on port 636 and specifies a custom DNS server. 
      Using LDAPS is necessary in environments where LDAP signing is enforced or cleartext LDAP is blocked. 
      Specifying a nameserver ensures the tool can resolve internal domain names when your local DNS is not configured for the target.
    command: "bloodhound-python -u {{username}} -p {{password}} -d {{domain}}  --use-ldaps -ns {{dns_ip}} "

  - title: bloodhound-python - define target computer list
    desc: |
      Specifies a text file containing a list of target computer FQDNs to enumerate. 
      This allows you to scope the enumeration to a specific subset of machines rather than the entire domain. 
      It is useful for staying within the boundaries of a specific engagement scope.
    command: "bloodhound-python -u {{username}} -p {{password}} -d {{domain}}  --computerfile {{file_path}} "

  # === PERFORMANCE & OUTPUT ===
  - title: bloodhound-python - optimized collection with compression
    desc: |
      Increases the number of worker threads to speed up the enumeration process in large environments. 
      The --zip flag automatically packages all generated JSON files into a single compressed archive for easy download. 
      Adding an output prefix helps distinguish between results from different domains or different phases of a test.
    command: "bloodhound-python -u {{username}} -p {{password}} -d {{domain}}  -w {workers|20} --zip -op {{prefix_name}} "