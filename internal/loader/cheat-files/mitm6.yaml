tool: mitm6
tags: [network, pentest, security, exploitation, mitm, ipv6, active-directory, dns]

actions:
  # === BASIC EXPLOITATION ===
  - title: mitm6 - basic network takeover
    desc: |
      Launches a basic IPv6 DNS takeover attack on the specified interface.
      This command starts listening for DHCPv6 requests and replies to them, making the attacker's machine the primary DNS server for victims.
      It is the most common starting point for internal network penetration tests where IPv6 is enabled but unconfigured.
      Ensure you are running this as root or with sudo privileges to manage network interfaces.
    command: "mitm6 -i {{interface|eth0}}"

  - title: mitm6 - target specific domain
    desc: |
      Filters the attack to only respond to DHCPv6 and DNS requests from a specific domain.
      This is highly recommended in enterprise environments to avoid affecting guest networks or unrelated machines.
      Using the -d flag reduces the noise generated by the tool and focuses exploitation efforts on the target AD domain.
      It helps prevent unintended consequences on systems outside the assessment scope.
    command: "mitm6 -i {{interface|eth0}} -d {{domain_name}}"

  # === ADVANCED RELAYING & AUTHENTICATION ===
  - title: mitm6 - relay target for credential capture
    desc: |
      Configures a relay target hostname to trigger authentication attempts.
      This is typically used in conjunction with ntlmrelayx to capture or relay NTLM/Kerberos credentials.
      The tool will provide this fake hostname as the DNS server, forcing victims to authenticate when they attempt to connect to it.
      Note that this is one of the most effective ways to escalate privileges in a Windows environment without existing credentials.
    command: "mitm6 -i {{interface|eth0}} -d {{domain_name}} -r {{relay_target_hostname}}"

  - title: mitm6 - attack with local domain search suffix
    desc: |
      Sets a custom local domain name to be used as the DNS search domain for victims.
      This can be used to hijack short-name resolutions (e.g., 'wpad' or 'fileserver') by appending the search suffix.
      By default, mitm6 uses the first DNS domain it encounters, but manually setting this can improve reliability.
      It is particularly useful when you want to ensure victims look for resources within your controlled namespace.
    command: "mitm6 -i {{interface|eth0}} -l {{local_domain|corp.local}}"

  # === STEALTH AND FILTERING ===
  - title: mitm6 - stealth mode (no router advertisements)
    desc: |
      Disables the sending of Router Advertisements (RA) during the attack.
      Some network security solutions or "Rogue RA" protections may trigger alerts when they see unauthorized RAs on the wire.
      This mode relies exclusively on DHCPv6 responses to assign DNS settings, which is often enough for Windows targets.
      Use this flag when you need to maintain a lower profile while still performing DNS hijacking.
    command: "mitm6 -i {{interface|eth0}} -a"

  - title: mitm6 - whitelist specific hosts
    desc: |
      Limits the attack to only target specific hostnames via an allowlist.
      This is crucial when you have been assigned specific targets and want to ensure no other production machines are affected.
      The -hw flag accepts FQDNs and will ignore any DHCPv6 queries from hosts not in this list.
      It provides a safe way to conduct testing on a subset of the network.
    command: "mitm6 -i {{interface|eth0}} -hw {{target_hostname}}"

  - title: mitm6 - blacklist sensitive hosts
    desc: |
      Prevents the tool from responding to requests from specific sensitive hosts.
      This is best used to protect Domain Controllers or critical servers from being accidentally disrupted by DNS changes.
      The -hb flag ensures that the specified machines will continue using their legitimate DNS settings.
      Always verify critical infrastructure hostnames before starting a wide-scale mitm6 attack.
    command: "mitm6 -i {{interface|eth0}} -hb {{sensitive_hostname}}"

  - title: mitm6 - ignore non-FQDN queries
    desc: |
      Configures the tool to ignore DHCPv6 queries that do not contain a Fully Qualified Domain Name (FQDN).
      This filter helps in reducing processing overhead and ignoring "noisy" or irrelevant traffic from devices not joined to a domain.
      It ensures that the tool focuses on professional workstations and servers that are likely to provide useful credentials.
      This is a common cleanup option for long-running sessions.
    command: "mitm6 -i {{interface|eth0}} --ignore-nofqdn"

  # === DEBUGGING ===
  - title: mitm6 - verbose debug output
    desc: |
      Runs the tool with maximum verbosity and debugging information enabled.
      Use this if you suspect the attack is not working as expected or if clients are not receiving IPv6 addresses.
      It displays detailed packet information and internal logic decisions made by the tool.
      Be aware that this will generate a large amount of terminal output in busy networks.
    command: "mitm6 -i {{interface|eth0}} -v --debug"